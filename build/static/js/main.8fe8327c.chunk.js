(this.webpackJsonpdiploma_front=this.webpackJsonpdiploma_front||[]).push([[0],Array(28).concat([function(e,t,a){},,function(e,t,a){},function(e,t,a){},function(e,t,a){},,,,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){"use strict";a.r(t);var i=a(1),n=a.n(i),s=a(21),c=a.n(s),o=a(2),r=(a(28),a(29),a(3)),l=(a(30),a(5)),u=Object(i.createContext)({currentUser:null,setCurrentUser:function(e){}}),d=(a(31),a(32),a(0));var j=function(){return Object(d.jsxs)("div",{className:"Portfolio",children:[Object(d.jsx)("h4",{className:"Portfolio__title",children:"\u041f\u043e\u0440\u0442\u0444\u043e\u043b\u0438\u043e"}),Object(d.jsxs)("ul",{className:"Portfolio__list",children:[Object(d.jsx)("li",{className:"Portfolio__item",children:Object(d.jsx)(o.b,{className:"Portfolio__link",to:"#",children:"\u0421\u0442\u0430\u0442\u0438\u0447\u043d\u044b\u0439 \u0441\u0430\u0439\u0442"})}),Object(d.jsx)("li",{className:"Portfolio__item",children:Object(d.jsx)(o.b,{className:"Portfolio__link",to:"#",children:"\u0410\u0434\u0430\u043f\u0442\u0438\u0432\u043d\u044b\u0439 \u0441\u0430\u0439\u0442"})}),Object(d.jsx)("li",{className:"Portfolio__item",children:Object(d.jsx)(o.b,{className:"Portfolio__link",to:"#",children:"\u041e\u0434\u043d\u043e\u0441\u0442\u0440\u0430\u043d\u0438\u0447\u043d\u043e\u0435 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435"})})]})]})};var m=function(){return Object(d.jsxs)("section",{id:"AboutMe",className:"AboutMe",children:[Object(d.jsx)("h3",{className:"AboutMe__title",children:"\u0421\u0442\u0443\u0434\u0435\u043d\u0442"}),Object(d.jsxs)("div",{className:"AboutMe__text-wrapper",children:[Object(d.jsx)("p",{className:"AboutMe__name",children:"\u041e\u043b\u0435\u0433"}),Object(d.jsx)("p",{className:"AboutMe__profession",children:"\u0424\u0440\u043e\u043d\u0442\u0435\u043d\u0434-\u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a, 27 \u043b\u0435\u0442"}),Object(d.jsx)("p",{className:"AboutMe__bio",children:"\u042f \u0440\u043e\u0434\u0438\u043b\u0441\u044f \u0432 94 \u043e\u043c \u043d\u0430 \u043a\u0440\u0430\u044e \u0433\u043e\u0440\u043e\u0434\u0430 \u0424\u0440\u043e\u043d\u0442\u0435\u043d\u0434 \u043f\u043e\u0437\u0434\u043d\u043e \u0443\u0434\u0430\u0440\u0438\u043b \u0432 \u0433\u043e\u043b\u043e\u0432\u0443 \u0432 25 \u0430\u043a\u0442\u0438\u0432\u043d\u043e \u0432\u0435\u0440\u0441\u0442\u0430\u043b \u043d\u0435\u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u043e \u0412 \u041f\u0440\u0430\u043a\u0442\u0438\u043a\u0443\u043c\u0435 \u0434\u0435\u0432\u043e\u0447\u043a\u0438 \u0432\u043f\u0435\u0440\u0432\u044b\u0435 \u043f\u043e\u043a\u0430\u0437\u0430\u043b\u0438 \u043c\u043d\u0435 \u041e\u041e\u041f ."}),Object(d.jsx)("img",{src:"https://sun9-23.userapi.com/impg/wSiudxrs3U0RZGY0Yha-ztwmQiKZXUjpTdBOtA/L0eA0KILgNc.jpg?size=848x1280&quality=95&sign=ae2d8d8af705969c777ffabfacd304b0&type=album",alt:"\u0424\u043e\u0442\u043e \u043a\u0440\u0430\u0441\u0430\u0432\u0446\u0430",className:"AboutMe__photo"}),Object(d.jsxs)("ul",{className:"AboutMe__contacts-list",children:[Object(d.jsx)("li",{className:"AboutMe__contacts-item",children:Object(d.jsx)(o.b,{className:"AboutMe__link_contact",to:"https://www.facebook.com/o.mildz",children:"Facebook"})}),Object(d.jsx)("li",{className:"AboutMe__contacts-item",children:Object(d.jsx)(o.b,{className:"AboutMe__link_contact",to:"https://github.com/SidWonder",children:"Github"})})]})]}),Object(d.jsx)(j,{})]})};a(39);var _=function(){return Object(d.jsxs)("section",{id:"AboutProject",className:"AboutProject",children:[Object(d.jsx)("h3",{className:"AboutProject__title",children:"\u041e \u043f\u0440\u043e\u0435\u043a\u0442\u0435"}),Object(d.jsxs)("div",{className:"AboutProject__stages-wrapper",children:[Object(d.jsxs)("div",{className:"AboutProject__stage",children:[Object(d.jsx)("p",{className:"AboutProject__stageText",children:"\u0414\u0438\u043f\u043b\u043e\u043c\u043d\u044b\u0439 \u043f\u0440\u043e\u0435\u043a\u0442 \u0432\u043a\u043b\u044e\u0447\u0430\u043b 5 \u044d\u0442\u0430\u043f\u043e\u0432"}),Object(d.jsx)("p",{className:"AboutProject__stageSubtext",children:"\u0421\u043e\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043f\u043b\u0430\u043d\u0430, \u0440\u0430\u0431\u043e\u0442\u0443 \u043d\u0430\u0434 \u0431\u044d\u043a\u0435\u043d\u0434\u043e\u043c, \u0432\u0451\u0440\u0441\u0442\u043a\u0443, \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0444\u0443\u043d\u043a\u0446\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u043e\u0441\u0442\u0438 \u0438 \u0444\u0438\u043d\u0430\u043b\u044c\u043d\u044b\u0435 \u0434\u043e\u0440\u0430\u0431\u043e\u0442\u043a\u0438."})]}),Object(d.jsxs)("div",{className:"AboutProject__stage",children:[Object(d.jsx)("p",{className:"AboutProject__stageText",children:"\u041d\u0430 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u0434\u0438\u043f\u043b\u043e\u043c\u0430 \u0443\u0448\u043b\u043e 5 \u043d\u0435\u0434\u0435\u043b\u044c"}),Object(d.jsx)("p",{className:"AboutProject__stageSubtext",children:"\u0423 \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u044d\u0442\u0430\u043f\u0430 \u0431\u044b\u043b \u043c\u044f\u0433\u043a\u0438\u0439 \u0438 \u0436\u0451\u0441\u0442\u043a\u0438\u0439 \u0434\u0435\u0434\u043b\u0430\u0439\u043d, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043d\u0443\u0436\u043d\u043e \u0431\u044b\u043b\u043e \u0441\u043e\u0431\u043b\u044e\u0434\u0430\u0442\u044c, \u0447\u0442\u043e\u0431\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0449\u0438\u0442\u0438\u0442\u044c\u0441\u044f."})]})]}),Object(d.jsxs)("div",{className:"AboutProject__progressBar",children:[Object(d.jsx)("span",{className:"AboutProject__progressBarItem AboutProject__progressBarItem_backend",children:Object(d.jsx)("p",{className:"AboutProject__progressBarText",children:"1 \u043d\u0435\u0434\u0435\u043b\u044f"})}),Object(d.jsx)("span",{className:"AboutProject__progressBarItem AboutProject__progressBarItem_frontend",children:Object(d.jsx)("p",{className:"AboutProject__progressBarText",children:"4 \u043d\u0435\u0434\u0435\u043b\u0438"})})]})]})};a(40);var b=function(){return Object(d.jsx)("nav",{className:"NavTab",children:Object(d.jsxs)("ul",{className:"NavTab__list",children:[Object(d.jsx)("li",{className:"NavTab__listItem",children:Object(d.jsx)("a",{href:"#AboutProject",className:"NavTab__link",children:"\u041e \u043f\u0440\u043e\u0435\u043a\u0442\u0435"})}),Object(d.jsx)("li",{className:"NavTab__listItem",children:Object(d.jsx)("a",{href:"#Techs",className:"NavTab__link",children:"\u0422\u0435\u0445\u043d\u043e\u043b\u043e\u0433\u0438\u0438"})}),Object(d.jsx)("li",{className:"NavTab__listItem",children:Object(d.jsx)("a",{href:"#AboutMe",className:"NavTab__link",children:"\u0421\u0442\u0443\u0434\u0435\u043d\u0442"})})]})})};a(41);var v=function(){return Object(d.jsx)("section",{className:"Promo",children:Object(d.jsx)("p",{className:"Promo__mainText",children:"\u0423\u0447\u0435\u0431\u043d\u044b\u0439 \u043f\u0440\u043e\u0435\u043a\u0442 \u0441\u0442\u0443\u0434\u0435\u043d\u0442\u0430 \u0444\u0430\u043a\u0443\u043b\u044c\u0442\u0435\u0442\u0430 \u0412\u0435\u0431-\u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0438."})})};a(42);var h=function(){return Object(d.jsxs)("section",{id:"Techs",className:"Techs",children:[Object(d.jsx)("h3",{className:"Techs__header",children:"\u0422\u0435\u0445\u043d\u043e\u043b\u043e\u0433\u0438\u0438"}),Object(d.jsx)("p",{className:"Techs__title",children:"7 \u0442\u0435\u0445\u043d\u043e\u043b\u043e\u0433\u0438\u0438"}),Object(d.jsx)("p",{className:"Techs__subtitle",children:"\u041d\u0430 \u043a\u0443\u0440\u0441\u0435 \u0432\u0435\u0431-\u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0438 \u043c\u044b \u043e\u0441\u0432\u043e\u0438\u043b\u0438 \u0442\u0435\u0445\u043d\u043e\u043b\u043e\u0433\u0438\u0438, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043f\u0440\u0438\u043c\u0435\u043d\u0438\u043b\u0438 \u0432 \u0434\u0438\u043f\u043b\u043e\u043c\u043d\u043e\u043c \u043f\u0440\u043e\u0435\u043a\u0442\u0435."}),Object(d.jsxs)("ul",{className:"Techs__list",children:[Object(d.jsx)("li",{className:"Techs__listItem",children:"HTML"}),Object(d.jsx)("li",{className:"Techs__listItem",children:"CSS"}),Object(d.jsx)("li",{className:"Techs__listItem",children:"JS"}),Object(d.jsx)("li",{className:"Techs__listItem",children:"React"}),Object(d.jsx)("li",{className:"Techs__listItem",children:"Git"}),Object(d.jsx)("li",{className:"Techs__listItem",children:"Express.js"}),Object(d.jsx)("li",{className:"Techs__listItem",children:"mongoDB"})]})]})};a(43),a(44);var g=function(e){var t=e.pageType,a=e.mobile,n=e.loggedIn,s=Object(i.useRef)(null),c=function(){s.current.classList.contains("Navigation__list_mobile-active")?s.current.classList.remove("Navigation__list_mobile-active"):s.current.classList.add("Navigation__list_mobile-active")};return Object(d.jsxs)("nav",{className:"Navigation ".concat(a?"Navigation__mobile":"Navigation__desktop"),children:["main"===t&&Object(d.jsxs)("ul",{className:"Navigation__list Navigation__list_main",children:[Object(d.jsx)("li",{className:"Navigation__listItem_main Navigation__listItem_registration",children:n?Object(d.jsx)(o.b,{to:"/movies",className:"Navigation__link Navigation__link_auth",children:"\u0424\u0438\u043b\u044c\u043c\u044b"}):Object(d.jsx)(o.b,{to:"/signup",className:"Navigation__link Navigation__link_auth",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"})}),Object(d.jsx)("li",{className:"Navigation__listItem_main Navigation__listItem_login",children:n?Object(d.jsx)(o.b,{to:"/saved-movies",className:"Navigation__link Navigation__link_auth",children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u044b\u0435 \u0444\u0438\u043b\u044c\u043c\u044b"}):Object(d.jsx)(o.b,{to:"/signin",className:"Navigation__link Navigation__link_auth Navigation__link_auth_active",children:"\u0412\u043e\u0439\u0442\u0438"})})]}),("allMovies"===t||"savedMovies"===t||"profile"===t)&&a&&Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)("button",{onClick:c,className:"Navigation__button_menuToggle"}),Object(d.jsxs)("ul",{ref:s,className:"Navigation__list Navigation__list_default Navigation__list_mobile",children:[Object(d.jsx)("button",{onClick:c,className:"Navigation__button_close"}),Object(d.jsx)("li",{className:"Navigation__listItem_default Navigation__listItem_default-mobile",children:Object(d.jsx)(o.b,{to:"/",className:"Navigation__link Navigation__link_movies",children:"\u0413\u043b\u0430\u0432\u043d\u0430\u044f"})}),Object(d.jsx)("li",{className:"Navigation__listItem_default Navigation__listItem_default-mobile",children:Object(d.jsx)(o.b,{to:"/movies",className:"Navigation__link Navigation__link_movies",children:"\u0424\u0438\u043b\u044c\u043c\u044b"})}),Object(d.jsx)("li",{className:"Navigation__listItem_default Navigation__listItem_default-mobile",children:Object(d.jsx)(o.b,{to:"/saved-movies",className:"Navigation__link Navigation__link_savedMovies",children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u044b\u0435 \u0444\u0438\u043b\u044c\u043c\u044b"})}),Object(d.jsx)("li",{className:"Navigation__listItem_default Navigation__listItem_default-mobile",children:Object(d.jsx)(o.b,{to:"/profile",className:"Navigation__link Navigation__link_account",children:"\u0410\u043a\u043a\u0430\u0443\u043d\u0442"})})]})]}),("allMovies"===t||"savedMovies"===t||"profile"===t)&&!a&&Object(d.jsx)(d.Fragment,{children:Object(d.jsxs)("ul",{ref:s,className:"Navigation__list\n                                Navigation__list_default\n                                Navigation__list_desktop",children:[Object(d.jsx)("li",{className:"Navigation__listItem_default Navigation__listItem_default-desktop",children:Object(d.jsx)(o.b,{to:"/movies",className:"Navigation__link Navigation__link_movies",children:"\u0424\u0438\u043b\u044c\u043c\u044b"})}),Object(d.jsx)("li",{className:"Navigation__listItem_default Navigation__listItem_default-desktop",children:Object(d.jsx)(o.b,{to:"/saved-movies",className:"Navigation__link Navigation__link_savedMovies",children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u044b\u0435 \u0444\u0438\u043b\u044c\u043c\u044b"})}),Object(d.jsx)("li",{className:"Navigation__listItem_default Navigation__listItem_default-desktop",children:Object(d.jsx)(o.b,{to:"/profile",className:"Navigation__link Navigation__link_account",children:"\u0410\u043a\u043a\u0430\u0443\u043d\u0442"})})]})})]})},f={onStart:12,addMore:3},p={onStart:8,addMore:2},O={onStart:5,addMore:2},x="allMovies",N="savedMovies",y="login",S="register";var k=function(e){var t=e.pageType,a=e.loggedIn,i=y,s=S,c=n.a.useState(null),l=Object(r.a)(c,2),u=l[0],j=l[1];function m(){var e=document.body.getBoundingClientRect().width;j(e>=320&&e<=1023)}return n.a.useEffect((function(){m(),window.addEventListener("resize",m)}),[]),Object(d.jsxs)("header",{className:"Header Header__".concat(t),children:[Object(d.jsx)(o.b,{to:"/",className:"Header__link_logo"}),t===s&&Object(d.jsx)("h2",{className:"Header__title",children:"\u0414\u043e\u0431\u0440\u043e \u043f\u043e\u0436\u0430\u043b\u043e\u0432\u0430\u0442\u044c!"}),t===i&&Object(d.jsx)("h2",{className:"Header__title",children:"\u0420\u0430\u0434\u044b \u0432\u0438\u0434\u0435\u0442\u044c!"}),Object(d.jsx)(g,{pageType:t,mobile:u,loggedIn:a})]})};var M=function(e){var t=e.loggedIn;return Object(d.jsxs)("section",{className:"Main",children:[Object(d.jsx)(k,{pageType:"main",loggedIn:t}),Object(d.jsx)(v,{}),Object(d.jsx)(b,{}),Object(d.jsx)(_,{}),Object(d.jsx)(h,{}),Object(d.jsx)(m,{})]})},T=a(19);a(45),a(46),a(47);var I=function(e){var t=e.type,a=e.setFlag;return Object(d.jsxs)("div",{className:"FilterCheckbox",children:[Object(d.jsx)("p",{className:"FilterCheckbox__type",children:t}),Object(d.jsxs)("label",{className:"FilterCheckbox__switch",children:[Object(d.jsx)("input",{onClick:function(e){var t=e.target.checked;a(t)},type:"checkbox",className:"FilterCheckbox__input"}),Object(d.jsx)("span",{className:"FilterCheckbox__slider"})]})]})};a(48);var F=function(e){var t=e.errorText;return Object(d.jsx)("p",{className:"ValidationError",children:t})};var C=function(e){var t=e.setMovies,a=e.moviesForSrch,n=e.setIsLoading,s=e.pageType,c=Object(i.useState)(!0),o=Object(r.a)(c,2),l=o[0],u=o[1],j=Object(i.useState)(""),m=Object(r.a)(j,2),_=m[0],b=m[1],v=Object(i.useState)(null),h=Object(r.a)(v,2),g=h[0],f=h[1],p=Object(i.useState)(!1),O=Object(r.a)(p,2),N=O[0],y=O[1],S=Object(i.useRef)(!0),k=x;function M(){f(null),u(!0)}function T(e){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log(N);var c=e.trim(),o=new RegExp(c,"gi"),r=a.filter((function(e){return e.nameRU.match(o)||e.nameEN&&e.nameEN.match(o)||e.description&&e.description.match(o)}));i&&(r=r.filter((function(e){return e.duration<=40}))),r.length?(s===k&&(localStorage.setItem("searchResults",JSON.stringify(r)),localStorage.setItem("searchQueryYa",JSON.stringify(_)),n(!1)),t(r)):(s===k&&n(!1),t("nullSearch"))}return Object(i.useEffect)((function(){if(S.current){var e=localStorage.getItem("searchQueryYa")||[];e.length>0&&b(e.replace(/['"]/gi,"").trim()),S.current=!1}}),[]),Object(i.useEffect)((function(){}),[g]),Object(d.jsxs)("form",{name:"searchForm",className:"SearchForm",onSubmit:function(e){if(M(),e.preventDefault(),_){if(!(_.length<3))return T(_);f("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u0435 \u043c\u0435\u043d\u0435\u0435 \u0442\u0440\u0451\u0445 \u0431\u0443\u043a\u0432"),u(!1)}else f("\u041d\u0443\u0436\u043d\u043e \u0432\u0432\u0435\u0441\u0442\u0438 \u043a\u043b\u044e\u0447\u0435\u0432\u043e\u0435 \u0441\u043b\u043e\u0432\u043e"),u(!1)},noValidate:!0,children:[Object(d.jsxs)("label",{className:"SearchForm__label",children:[Object(d.jsx)("input",{required:!0,minLength:3,type:"text",name:"searchInput",placeholder:"\u0424\u0438\u043b\u044c\u043c",className:"SearchForm__input ".concat(l?"":"SearchForm__input__error"),onChange:function(e){M(),b(e.target.value)},onFocus:M,value:_||""}),!l&&Object(d.jsx)(F,{errorText:g}),Object(d.jsx)("button",{className:"SearchForm__button",children:"\u041d\u0430\u0439\u0442\u0438"})]}),Object(d.jsx)(I,{type:"\u041a\u043e\u0440\u043e\u0442\u043a\u043e\u043c\u0435\u0442\u0440\u0430\u0436\u043a\u0438",setFlag:function(e){y(e),T(_,e)}})]})};a(49),a(50);var E=function(e){var t=e.movieName,a=e.movieLength,i=e.movieCover,n=e.movieInFavorite,s=e.pageType,c=e.addMovieToFav,o=e.movieId,r=e.removeMovieFromFav,l=x,u=N;function j(){if(n)return console.log("try to remove",s),r(o,s);c(o)}return Object(d.jsxs)("div",{className:"MoviesCard",children:[Object(d.jsx)("p",{className:"MoviesCard__title",children:t}),Object(d.jsxs)("p",{className:"MoviesCard__length",children:[a," \u043c\u0438\u043d\u0443\u0442"]}),Object(d.jsx)("img",{src:i,alt:"\u041e\u0431\u043b\u043e\u0448\u043a\u0430 \u0444\u0438\u043b\u044c\u043c\u0430 ".concat(t),className:"MoviesCard__image"}),s===l&&Object(d.jsx)("button",{onClick:j,className:"MoviesCard__button ".concat(n&&"MoviesCard__button_inFavoriteMovieList"),children:!n&&"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"}),s===u&&Object(d.jsx)("button",{onClick:j,className:"MoviesCard__button MoviesCard__button_inFavoriteList"})]})},A=x,L=N;var P=function(e){var t=e.cards,a=e.pageType,i=e.addMovieToFav,n=e.favMovies,s=e.removeMovieFromFav;function c(e){i(e)}function o(e,t){if(console.log(e,t),t===L)return s(e._id);if(t===A){var a=n.filter((function(t){return t.movieId===e.id}))[0]._id;return s(a)}}return Object(d.jsxs)("section",{className:"MoviesCardList",children:[console.log(t,"MoviesCardList"),a===A&&(null===t||void 0===t?void 0:t.map((function(e){return Object(d.jsx)(E,{movieName:e.nameRU,movieLength:e.duration,movieCover:"https://api.nomoreparties.co".concat(e.image.url),movieInFavorite:(t=e.id,!!n.filter((function(e){return e.movieId===t})).length),addMovieToFav:function(){return c(e)},removeMovieFromFav:function(){return o(e,A)},pageType:A,movieId:e.id},e.id);var t}))),a===L&&(null===t||void 0===t?void 0:t.map((function(e){return Object(d.jsx)(E,{movieName:e.nameRU,movieLength:e.duration,movieCover:e.image,movieInFavorite:!0,removeMovieFromFav:function(){return o(e,L)},pageType:L},e._id)})))]})},w=(a(51),function(){return Object(d.jsx)("div",{className:"preloader",children:Object(d.jsx)("div",{className:"preloader__container",children:Object(d.jsx)("span",{className:"preloader__round"})})})}),R=a(15),B=a(16),U=new(function(){function e(t){Object(R.a)(this,e),this.url=t}return Object(B.a)(e,[{key:"getData",value:function(){return fetch(this.url).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}}]),e}())("https://api.nomoreparties.co/beatfilm-movies");var V=function(e){var t=e.addMovieToFav,a=e.removeMovieFromFav,n=e.favMovies,s=e.loggedIn,c=Object(i.useState)(!1),o=Object(r.a)(c,2),l=o[0],u=o[1],j=Object(i.useState)([]),m=Object(r.a)(j,2),_=m[0],b=m[1],v=Object(i.useState)([]),h=Object(r.a)(v,2),g=h[0],N=h[1],y=Object(i.useState)([]),S=Object(r.a)(y,2),M=S[0],I=S[1],F=Object(i.useState)(f),E=Object(r.a)(F,2),A=E[0],L=E[1],R=Object(i.useState)(0),B=Object(r.a)(R,2),V=B[0],z=B[1],D=Object(i.useState)(!1),J=Object(r.a)(D,2),q=J[0],H=J[1],Z=x;function G(){z(window.innerWidth)}return Object(i.useEffect)((function(){z(window.innerWidth),V<=760&&L(O),V>760&&V<=900&&L(p),V>900&&L(f)}),[V]),Object(i.useEffect)((function(){b(null===g||void 0===g?void 0:g.slice(0,A.onStart)),H(!0)}),[g,A.onStart]),Object(i.useEffect)((function(){function e(){setTimeout(G,600)}return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[]),Object(i.useEffect)((function(){(null===_||void 0===_?void 0:_.length)===(null===g||void 0===g?void 0:g.length)&&H(!1)}),[g,_]),Object(i.useEffect)((function(){!function(){u(!0);var e=localStorage.getItem("beatFilmDB");if(!e)return U.getData().then((function(e){I(e),localStorage.setItem("beatFilmDB",JSON.stringify(e))})).then((function(){return u(!1)}));I(JSON.parse(e));u(!1)}();var e=JSON.parse(localStorage.getItem("searchResults"));e&&N(e)}),[]),Object(d.jsxs)("section",{className:"Movies",children:[Object(d.jsx)(k,{loggedIn:s,pageType:Z}),Object(d.jsx)(C,{pageType:Z,setMovies:N,moviesForSrch:M,setIsLoading:u}),_.length&&"nullSearch"!==_&&Object(d.jsx)(P,{cards:_,favMovies:n,pageType:Z,addMovieToFav:t,removeMovieFromFav:a}),"nullSearch"===_&&Object(d.jsx)("p",{className:"Movies__null-search",children:"\u041d\u0438\u0447\u0435\u0433\u043e \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e"}),l&&Object(d.jsx)(w,{}),(null===_||void 0===_?void 0:_.length)>0&&q&&Object(d.jsx)("button",{className:"Movies__show-more-button",type:"button",onClick:function(){b([].concat(Object(T.a)(_),Object(T.a)(g.slice(_.length,_.length+A.addMore))))},children:"\u0415\u0449\u0451"})]})};a(52);var z=function(e){var t=e.logout,a=e.removeMovieFromFav,n=e.loggedIn,s=e.movies,c=e.getFavMovies,o=N,l=Object(i.useState)([]),u=Object(r.a)(l,2),j=u[0],m=u[1];return Object(i.useEffect)((function(){m(s)}),[s]),Object(d.jsxs)("section",{className:"SavedMovies",children:[Object(d.jsx)(k,{pageType:"savedMovies",loggedIn:n,logout:t}),Object(d.jsx)(C,{pageType:o,setMovies:m,moviesForSrch:s}),"nullSearch"===j&&Object(d.jsx)("p",{className:"Movies__null-search",children:"\u041d\u0438\u0447\u0435\u0433\u043e \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e"}),j.length&&"nullSearch"!==j&&Object(d.jsx)(P,{cards:j,favMovies:j,removeMovieFromFav:a,pageType:o,getFavMovies:c})]})};var D=function(e){var t=e.redirectTo,a=e.hasPermission,i=e.children;return Object(d.jsx)(l.b,{children:function(){return a?i:Object(d.jsx)(l.a,{to:t})}})};a(53);var J=function(){return Object(d.jsxs)("footer",{className:"Footer",children:[Object(d.jsx)("p",{className:"Footer__text",children:"\u0423\u0447\u0435\u0431\u043d\u044b\u0439 \u043f\u0440\u043e\u0435\u043a\u0442 \u042f\u043d\u0434\u0435\u043a\u0441.\u041f\u0440\u0430\u043a\u0442\u0438\u043a\u0443\u043c \u0445 BeatFilm."}),Object(d.jsxs)("ul",{className:"Footer__list",children:[Object(d.jsxs)("li",{className:"Footer__item",children:["\xa9 ",(new Date).getFullYear()]}),Object(d.jsx)("li",{className:"Footer__item",children:Object(d.jsx)(o.b,{to:"https://practicum.yandex.ru/",className:"Footer__link",children:"\u042f\u043d\u0434\u0435\u043a\u0441.\u041f\u0440\u0430\u043a\u0442\u0438\u043a\u0443\u043c"})}),Object(d.jsx)("li",{className:"Footer__item",children:Object(d.jsx)(o.b,{to:"https://github.com/SidWonder",className:"Footer__link",children:"Github"})}),Object(d.jsx)("li",{className:"Footer__item",children:Object(d.jsx)(o.b,{to:"https://www.facebook.com/o.mildz",className:"Footer__link",children:"Facebook"})})]})]})};a(54);var q=function(e){var t=e.handleRegister,a=e.handleLogin,s=e.loggedIn,c=Object(i.useState)(!1),u=Object(r.a)(c,2),j=u[0],m=u[1],_=Object(l.g)(),b=n.a.useState(""),v=Object(r.a)(b,2),h=v[0],g=v[1],f=n.a.useState(""),p=Object(r.a)(f,2),O=p[0],x=p[1],N=n.a.useState(""),y=Object(r.a)(N,2),S=y[0],M=y[1],T=Object(i.useState)(!1),I=Object(r.a)(T,2),F=I[0],C=I[1],E=function(e,t){document.getElementById("".concat(e.id,"Error")).textContent=t},A=function(e){var t=e.target;m(!1),t.validity.valid?(t.classList.remove("Register__error_input"),E(t,t.validationMessage)):(t.dataset.valid=!1,t.classList.add("Register__error_input"),E(t,t.validationMessage)),function(){var e=Array.from(document.getElementsByTagName("input")).every((function(e){return e.validity.valid}));C(e)}()};return Object(i.useEffect)((function(){!function(){var e=document.getElementById("Register__name");e.addEventListener("input",(function(){e.validity.patternMismatch?e.setCustomValidity("\u0418\u043c\u044f \u043c\u043e\u0436\u0435\u0442 \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0431\u0443\u043a\u0432\u044b, \u043f\u0440\u043e\u0431\u0435\u043b \u0438 \u0442\u0438\u0440\u0435."):e.validity.tooShort?e.setCustomValidity("\u0418\u043c\u044f \u0441\u043b\u0438\u0448\u043a\u043e\u043c \u043a\u043e\u0440\u043e\u0442\u043a\u043e\u0435."):e.validity.valueMissing?e.setCustomValidity("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0432\u0430\u0448\u0435 \u0438\u043c\u044f \u043d\u0430 \u043b\u0430\u0442\u0438\u043d\u0438\u0446\u0435 \u0438\u043b\u0438 \u043a\u0438\u0440\u0438\u043b\u043b\u0438\u0446\u0435."):e.setCustomValidity("")}));var t=document.getElementById("Register__email");t.addEventListener("input",(function(){t.validity.typeMismatch||t.validity.patternMismatch?t.setCustomValidity("\u042d\u0442\u043e \u043d\u0435 \u043f\u043e\u0445\u043e\u0436\u0435 \u043d\u0430 \u043d\u0430\u0441\u0442\u043e\u044f\u0449\u0438\u0439 email."):t.setCustomValidity("")}));var a=document.getElementById("Register__password");a.addEventListener("input",(function(){a.validity.tooShort?a.setCustomValidity("\u0421\u043b\u0438\u0448\u043a\u043e\u043c \u043a\u043e\u0440\u043e\u0442\u043a\u0438\u0439 \u043f\u0430\u0440\u043e\u043b\u044c, \u043c\u0438\u043d\u0438\u043c\u0443\u043c 8 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432 (\u0421\u0435\u0439\u0447\u0430\u0441 ".concat(a.value.length,").")):a.setCustomValidity("")}))}()}),[]),Object(i.useEffect)((function(){s&&_.push("/movies")}),[s]),Object(d.jsxs)("section",{className:"Register",children:[Object(d.jsx)(k,{pageType:"register"}),j&&Object(d.jsx)("div",{className:"Register__error_api",children:j}),Object(d.jsxs)("form",{noValidate:!0,onSubmit:function(e){e.preventDefault();var i=e.target.name.value,n=e.target.email.value,s=e.target.password.value;t(i,n,s).then((function(e){if(e.ok)return e.json();if(409===e.status)throw m("\u0422\u0430\u043a\u043e\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0443\u0436\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442"),new Error("\u0422\u0430\u043a\u043e\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0443\u0436\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442")})).then((function(e){if(!e||400===e.status||409===e.status)return new Error;a(n,s)})).then((function(){return C(!1)})).catch((function(e){return console.log(e)}))},className:"Register__form",children:[Object(d.jsxs)("label",{className:"Register__label",children:["\u0418\u043c\u044f",Object(d.jsx)("input",{placeholder:"Username",type:"text",className:"Register__input",name:"name",id:"Register__name",onChange:function(e){g(e.target.value),A(e)},value:h,maxLength:"25",minLength:"2",pattern:"^[\u0410-\u042f\u0430-\u044fa-zA-Z]+(([' -][\u0410-\u042f\u0430-\u044fa-zA-Z ])?[\u0410-\u042f\u0430-\u044fa-zA-Z]*)*$",required:!0,autoFocus:"true"}),Object(d.jsx)("span",{className:"Register__error_text",id:"Register__nameError"})]}),Object(d.jsxs)("label",{className:"Register__label",children:["E-mail",Object(d.jsx)("input",{placeholder:"name@domain.com",name:"email",type:"email",className:"Register__input",id:"Register__email",pattern:"^\\S+@\\S+\\.\\S+$",minLength:"2",onChange:function(e){x(e.target.value),A(e)},value:O,required:!0,autoComplete:"nope"}),Object(d.jsx)("span",{className:"Register__error_text",id:"Register__emailError"})]}),Object(d.jsxs)("label",{className:"Register__label",children:["\u041f\u0430\u0440\u043e\u043b\u044c",Object(d.jsx)("input",{minLength:8,placeholder:"\u041d\u0435 \u043c\u0435\u043d\u0435\u0435 8 \u0437\u043d\u0430\u043a\u043e\u0432",type:"password",name:"password",className:"Register__input",id:"Register__password",autoComplete:"on",onChange:function(e){M(e.target.value),A(e)},value:S,required:!0}),Object(d.jsx)("span",{className:"Register__error_text",id:"Register__passwordError"})]}),Object(d.jsx)("button",{disabled:!F,type:"submit",className:"Register__button",children:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"}),Object(d.jsxs)("p",{className:"Register__text",children:["\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b? ",Object(d.jsx)(o.b,{to:"/signin",className:"Register__link",children:"\u0412\u043e\u0439\u0442\u0438"})]})]})]})};a(55);var H=function(e){var t=e.handleLogin,a=e.loggedIn,n=Object(l.g)(),s=Object(i.useState)(""),c=Object(r.a)(s,2),u=c[0],j=c[1],m=Object(i.useState)(""),_=Object(r.a)(m,2),b=_[0],v=_[1],h=Object(i.useState)(!1),g=Object(r.a)(h,2),f=g[0],p=g[1],O=function(e,t){document.getElementById("".concat(e.id,"Error")).textContent=t},x=function(e){var t=e.target;t.validity.valid||(t.dataset.valid=!1),O(t,t.validationMessage),function(){var e=Array.from(document.getElementsByTagName("input")).every((function(e){return e.validity.valid}));console.log(e),p(e)}()};return Object(i.useEffect)((function(){!function(){var e=document.getElementById("Login__email");e.addEventListener("input",(function(){e.validity.typeMismatch||e.validity.patternMismatch?e.setCustomValidity("\u042d\u0442\u043e \u043d\u0435 \u043f\u043e\u0445\u043e\u0436\u0435 \u043d\u0430 \u043d\u0430\u0441\u0442\u043e\u044f\u0449\u0438\u0439 email."):e.setCustomValidity("")}));var t=document.getElementById("Login__password");t.addEventListener("input",(function(){t.validity.tooShort?t.setCustomValidity("\u0421\u043b\u0438\u0448\u043a\u043e\u043c \u043a\u043e\u0440\u043e\u0442\u043a\u0438\u0439 \u043f\u0430\u0440\u043e\u043b\u044c, \u043c\u0438\u043d\u0438\u043c\u0443\u043c 8 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432 (\u0421\u0435\u0439\u0447\u0430\u0441 ".concat(t.value.length,").")):t.setCustomValidity("")}))}()}),[]),Object(i.useEffect)((function(){a&&n.push("/movies")}),[a]),Object(d.jsxs)("section",{className:"Login",children:[Object(d.jsx)(k,{pageType:"login"}),Object(d.jsxs)("form",{noValidate:!0,autoComplete:"off",onSubmit:function(e){e.preventDefault();var a=e.target.email.value,i=e.target.password.value;t(a,i),p(!1)},className:"Login__form",children:[Object(d.jsxs)("label",{className:"Login__label",children:["E-mail",Object(d.jsx)("input",{id:"Login__email",name:"email",type:"text",autoComplete:"off",placeholder:"example@test.ru",pattern:"^\\S+@\\S+\\.\\S+$",minLength:"2",className:"Login__input",onChange:function(e){j(e.target.value),x(e)},value:u,required:!0}),Object(d.jsx)("span",{className:"Login__errorText",id:"Login__emailError"})]}),Object(d.jsxs)("label",{className:"Login__label",children:["\u041f\u0430\u0440\u043e\u043b\u044c",Object(d.jsx)("input",{style:{background:"none"},id:"Login__password",name:"password",type:"password",autoComplete:"off",required:!0,onChange:function(e){v(e.target.value),x(e)},value:b,minLength:"8",className:"Login__input"}),Object(d.jsx)("span",{className:"Login__errorText",id:"Login__passwordError"})]}),Object(d.jsx)("button",{disabled:!f,type:"submit",className:"Login__button",children:"\u0412\u043e\u0439\u0442\u0438"}),Object(d.jsxs)("p",{className:"Login__text",children:["\u0415\u0449\u0451 \u043d\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b? ",Object(d.jsx)(o.b,{to:"/signup",className:"Login__link",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"})]})]})]})};a(56);var Z=function(e){var t=e.handleUpdateUserData,a=e.logout,n=Object(i.useContext)(u).currentUser,s=n.email,c=n.name,o=Object(i.useState)(""),l=Object(r.a)(o,2),j=l[0],m=l[1],_=Object(i.useState)(""),b=Object(r.a)(_,2),v=b[0],h=b[1],g=Object(i.useState)(!1),f=Object(r.a)(g,2),p=f[0],O=f[1];function x(e,t,a){console.log(e,t,a);var i=document.getElementById("".concat(e.id,"Error"));e.classList.toggle("profile__error",a),i.textContent=t,i.classList.toggle("profile__error-message_shown",a),O(!1)}function N(e){var t=e.target;t.validity.valid?x(t,t.validationMessage,!1):(t.dataset.valid=!1,x(t,t.validationMessage,!0)),function(){var e=Array.from(document.getElementsByTagName("input")).every((function(e){return e.validity.valid}));O(e)}()}return Object(i.useEffect)((function(){console.log("PROFILE SHIIIIT",n),m(c),h(s)}),[n]),Object(i.useEffect)((function(){!function(){var e=document.getElementById("Profile__name");e.addEventListener("input",(function(){e.validity.patternMismatch?e.setCustomValidity("\u0418\u043c\u044f \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u043d\u0435\u0434\u043e\u043f\u0443\u0441\u0442\u0438\u043c\u044b\u0435 \u0441\u0438\u043c\u0432\u043e\u043b\u044b."):e.validity.tooShort?e.setCustomValidity("\u0418\u043c\u044f \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u0435 2 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432."):e.validity.valueMissing?e.setCustomValidity("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0432\u0430\u0448\u0435 \u0438\u043c\u044f \u043d\u0430 \u043b\u0430\u0442\u0438\u043d\u0438\u0446\u0435 \u0438\u043b\u0438 \u043a\u0438\u0440\u0438\u043b\u043b\u0438\u0446\u0435."):e.setCustomValidity("")}));var t=document.getElementById("Profile__email");t.addEventListener("input",(function(){t.validity.typeMismatch||t.validity.patternMismatch?t.setCustomValidity("email \u0443\u043a\u0430\u0437\u0430\u043d \u0441 \u043e\u0448\u0438\u0431\u043a\u043e\u0439, \u043e\u043d \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u0432\u0438\u0434\u0430 example@test.ru"):t.setCustomValidity("")}))}()}),[]),Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(k,{pageType:"profile"}),Object(d.jsxs)("section",{className:"Profile",children:[Object(d.jsxs)("h1",{className:"Profile__title",children:["\u041f\u0440\u0438\u0432\u0435\u0442, ",c,"!"]}),Object(d.jsxs)("form",{noValidate:!0,onSubmit:function(e){return e.preventDefault(),console.log(j,v),void t(j,v)},className:"Profile__container",children:[Object(d.jsxs)("label",{className:"Profile__textContainer",children:[Object(d.jsx)("p",{className:"Profile__text",children:"\u0418\u043c\u044f"}),Object(d.jsx)("input",{className:"Profile__text",minLength:2,id:"Profile__name",value:j,type:"text",pattern:"^[\u0410-\u042f\u0430-\u044fa-zA-Z]+(([' -][\u0410-\u042f\u0430-\u044fa-zA-Z ])?[\u0410-\u042f\u0430-\u044fa-zA-Z]*)*$",required:!0,onChange:function(e){m(e.target.value),N(e)}}),Object(d.jsx)("span",{className:"profile__error-message",id:"Profile__nameError"})]}),Object(d.jsxs)("label",{className:"Profile__textContainer",children:[Object(d.jsx)("p",{className:"Profile__text",children:"E-mail"}),Object(d.jsx)("input",{id:"Profile__email",className:"Profile__text",type:"email",value:v,pattern:"^\\S+@\\S+\\.\\S+$",minLength:"2",required:!0,onChange:function(e){h(e.target.value),N(e)}}),Object(d.jsx)("span",{className:"profile__error-message",id:"Profile__emailError"})]}),Object(d.jsx)("button",{disabled:!p,type:"submit",className:"Profile__button Profile__button_registration",children:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c"}),Object(d.jsx)("button",{onClick:a,className:"Profile__button Profile__button_logout",children:"\u0412\u044b\u0439\u0442\u0438 \u0438\u0437 \u0430\u043a\u043a\u0430\u0443\u043d\u0442\u0430"})]})]})]})};a(57);var G=function(){return Object(d.jsxs)("section",{className:"NotFound",children:[Object(d.jsx)("h1",{className:"NotFound__number",children:"404"}),Object(d.jsx)("p",{className:"NotFound__text",children:"\u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430"}),Object(d.jsx)(o.b,{className:"NotFound__link",to:"/",children:"\u041d\u0430\u0437\u0430\u0434"})]})},Y=new(function(){function e(t){var a=t.baseUrl;Object(R.a)(this,e),this._baseUrl=a,this._headers={Accept:"application/json","Content-Type":"application/json"},this._headersAuth={Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(this._token)}}return Object(B.a)(e,[{key:"setToken",value:function(e){return console.log(this._token),this._token=e}},{key:"createUser",value:function(e,t,a){return fetch("".concat(this._baseUrl,"/signup"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},credentials:"include",body:JSON.stringify({name:e,password:a,email:t})})}},{key:"login",value:function(e,t){return fetch("".concat(this._baseUrl,"/signin"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:e,password:t}),credentials:"include"}).then((function(e){return e})).then((function(e){if(e.ok)return e.json();throw 400===e.status?new Error("\u043d\u0435 \u043f\u0435\u0440\u0435\u0434\u0430\u043d\u043e \u043e\u0434\u043d\u043e \u0438\u0437 \u043f\u043e\u043b\u0435\u0439"):401===e.status?new Error("\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0441 email \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d"):new Error("\u0447\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a")})).catch((function(e){console.log(e)}))}},{key:"getUserData",value:function(e){var t=this;return fetch("".concat(this._baseUrl,"/users/me"),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(e)},credentials:"include"}).then((function(e){return e})).then((function(e){if(console.log(t._headersAuth),401===e.status)throw new Error("\u0422\u043e\u043a\u0435\u043d \u043d\u0435 \u043f\u0435\u0440\u0435\u0434\u0430\u043d \u0438\u043b\u0438 \u043f\u0435\u0440\u0435\u0434\u0430\u043d \u043d\u0435 \u0432 \u0442\u043e\u043c \u0444\u043e\u0440\u043c\u0430\u0442\u0435");if(400===e.status)throw new Error("\u041f\u0435\u0440\u0435\u0434\u0430\u043d\u043d\u044b\u0439 \u0442\u043e\u043a\u0435\u043d \u043d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u0435\u043d");return e.json()})).catch((function(e){console.log(e)}))}},{key:"editUserData",value:function(e,t){var a=e.name,i=e.email;return fetch("".concat(this._baseUrl,"/users/me"),{method:"PATCH",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(t)},credentials:"include",body:JSON.stringify({name:a,email:i})}).then((function(e){return e})).catch((function(e){return console.log(e)}))}},{key:"getFavMovies",value:function(e){return fetch("".concat(this._baseUrl,"/movies"),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(e)},credentials:"include"}).then((function(e){return e.json()})).catch((function(e){return console.log(e)}))}},{key:"addToFav",value:function(e,t){return fetch("".concat(this._baseUrl,"/movies"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(t)},credentials:"include",body:JSON.stringify({movieId:e.id,country:e.country||"unknown",director:e.director,duration:e.duration,year:e.year,description:e.description,image:"https://api.nomoreparties.co".concat(e.image.url),thumbnail:"https://api.nomoreparties.co".concat(e.image.formats.thumbnail.url),trailer:e.trailerLink,nameRU:e.nameRU,nameEN:e.nameEN||"unknown"})}).then((function(e){return e.ok?e.json():Promise.reject(new Error("".concat(e.status)))})).catch((function(e){console.log(e)}))}},{key:"removeFromFav",value:function(e,t){return fetch("".concat(this._baseUrl,"/movies/").concat(e),{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(t)},credentials:"include"})}}]),e}())({baseUrl:"https://api.sidwonder.diploma.nomoredomains.rocks"});var $=function(){var e=Object(i.useState)(!1),t=Object(r.a)(e,2),a=t[0],n=t[1],s=Object(i.useState)({}),c=Object(r.a)(s,2),o=c[0],j=c[1],m=Object(i.useState)([]),_=Object(r.a)(m,2),b=_[0],v=_[1],h=Object(l.g)(),g=localStorage.getItem("token"),f=Object(l.h)().pathname,p=N,O=Object(i.useRef)(!0);function x(e){Y.removeFromFav(e,g).then((function(){return S()}))}function y(){var e=localStorage.getItem("token");e&&(n(!0),h.push(f),Y.setToken(e),Y.getUserData(e).then((function(e){var t=e.user?e.user:{};j(t),S()})).catch((function(e){return console.log(e)})))}function S(){var e=localStorage.getItem("token");Y.getFavMovies(e).then((function(e){v(e)})).catch((function(e){console.log(e)}))}function k(e,t){Y.login(e,t).then((function(e){e.token&&(n(!0),localStorage.setItem("token",e.token),Y.setToken(e.token),h.push("/movies"))})).then((function(){return y()})).catch((function(e){return console.log(e)}))}function T(){localStorage.clear(),n(!1),h.push("/"),j({})}return Object(i.useEffect)((function(){O.current&&(y(),O.current=!1)})),Object(i.useEffect)((function(){g=localStorage.getItem("token")}),[o]),Object(d.jsx)(u.Provider,{value:{currentUser:o,setCurrentUser:j},children:Object(d.jsx)("div",{className:"App",children:Object(d.jsxs)(l.d,{children:[Object(d.jsx)(l.b,{exact:!0,path:"/",children:Object(d.jsx)(M,{loggedIn:a})}),Object(d.jsx)(l.b,{path:"/signin",children:Object(d.jsx)(H,{handleLogin:k,loggedIn:a})}),Object(d.jsx)(l.b,{path:"/signup",children:Object(d.jsx)(q,{handleRegister:function(e,t,a){return Y.createUser(e,t,a)},handleLogin:k,loggedIn:a})}),Object(d.jsxs)(D,{path:"/movies",redirectTo:"/signin",hasPermission:a,children:[Object(d.jsx)(V,{logout:T,loggedIn:a,favMovies:b,addMovieToFav:function(e){Y.addToFav(e,g).then((function(){return S()}))},removeMovieFromFav:x,getFavMovies:S}),Object(d.jsx)(J,{})]}),Object(d.jsxs)(D,{path:"/saved-movies",redirectTo:"/signin",hasPermission:a,children:[Object(d.jsx)(z,{logout:T,setFavMoviesCards:v,loggedIn:a,movies:b,removeMovieFromFav:x,getFavMovies:S,pageType:p}),Object(d.jsx)(J,{})]}),Object(d.jsx)(D,{path:"/profile",redirectTo:"/signin",hasPermission:a,children:Object(d.jsx)(Z,{logout:T,handleUpdateUserData:function(e,t){Y.editUserData({name:e,email:t},g).then((function(){y()})).catch((function(e){return console.log(e)}))},loggedIn:a})}),Object(d.jsx)(l.b,{path:"/*",children:Object(d.jsx)(G,{})})]})})})};c.a.render(Object(d.jsx)(n.a.StrictMode,{children:Object(d.jsx)(o.a,{children:Object(d.jsx)($,{})})}),document.getElementById("root"))}]),[[58,1,2]]]);
//# sourceMappingURL=main.8fe8327c.chunk.js.map